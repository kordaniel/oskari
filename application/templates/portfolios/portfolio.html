{% extends "layout.html" %}

  {% block body %}
    <div>
      <h2>{{ portfolio.name }}</h2>
      <ul>
        <li>Portfolio owner: {{ portfolio.account_name() }}</li>
        <li><a href="{{ url_for('user_view', user_id=portfolio.account_id) }}">Back to profile</a></li>
      </ul>
    </div>
    
    
    
    <!-- malli
    <table border="1">
        <form>
          <tr><th>MALLI</th></tr>
            <tr>
              <td><input type="text" size="4" name="ticker" placeholder="TICKER" /></td>
              <td><input type="text" size="10" name="name" placeholder="Enter name" /></td>
              <td><input type="number" name="amount" min="0" placeholder="0" /></td>
              <td colspan="2"><input type="date" name="date" placeholder="dd.mm.yyyy" /></td>
              <td colspan="2"><select name="buyOrSell">
                <option value="buy" selected>Buy</option>
                <option value="sell">Sell</option>
              </select></td>
              <td><input type="text" name="price" placeholder="Enter price" /></td>
              <td><input type="submit" value="Save" /></td>
            </tr>
          </form>
    </table> -->
    <div>
      <h4>Open positions</h4>
      
      <table border="1">
        {% if current_user.is_authenticated %}
        <tr>
          <form method="POST" action="{{ url_for('trade_create', portfolio_id=portfolio.id) }}">
            <td>{{ form.ticker }}</td>
            <td>{{ form.name }}</td>
            <td>{{ form.amount }}</td>
            <td>{{ form.date }}</td>
            <td>{{ form.price }}</td>
            <td colspan="2"><input type="submit" value="Add position" /></td>
          </form>
        </tr>
        <tr>
          <td>
            <ul>
              {% for error in form.ticker.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <ul>
              {% for error in form.name.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <ul>
              {% for error in form.amount.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <ul>
              {% for error in form.date.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <ul>
              {% for error in form.price.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </td>
        </tr>
        {% endif %}
        <tr>
          <th>Ticker</th>
          <th>Name</th>
          <th>Amount</th>
          <th>Buy date</th>
          <th>Price bought</th>
          <th>Current price</th>
          <th>Return</th>
        </tr>
        {% for trade in portfolio.trades %}
        <tr>
          <td>{{ trade.stocks[0].ticker }}</td>
          <td>{{ trade.stocks[0].name }}</td>
          <td>{{ trade.amount }}</td>
          <td>{{ trade.date_created }}</td>
          <td>{{ trade.buyprice }}</td>
          <td>NOT IMPLEMENTED</td>
          <td>NOT IMPLEMENTED</td>
        </tr>
        {% endfor %}
      </table>
  </div>
  <div>
    <h4>Closed positions</h4>
    <table border="1">
      <tr>
        <th>Ticker</th>
        <th>Name</th>
        <th>Amount</th>
        <th>Buy date</th>
        <th>Price bought</th>
        <th>Sell date</th>
        <th>Price sold</th>
        <th>Current price</th>
        <th>Return</th>
      </tr>
      {% for trade in portfolio.trades %}
      <tr>
        <td>{{ trade.stocks[0].ticker }}</td>
        <td>{{ trade.stocks[0].name }}</td>
        <td>{{ trade.amount }}</td>
        <td>{{ trade.date_created }}</td>
        <td>{{ trade.buyprice }}</td>
        <td>{{ trade.date_modified }}</td>
        <td>{{ trade.sellprice }}</td>
        <td>NOT IMPLEMENTED</td>
        <td>NOT IMPLEMENTED</td>
      </tr>
      {% endfor %}
    </table>
  </div>
  {% endblock %}